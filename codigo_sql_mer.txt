CREATE TABLE usuario
(
  id_usuario INT NOT NULL,
  nome VARCHAR(250) NOT NULL,
  senha VARCHAR(100) NOT NULL,
  tipo ENUM('Paciente','Médico','Coordenador') NOT NULL,
  ativo INT NOT NULL,
  cep VARCHAR(8) NOT NULL,
  uf_resid VARCHAR(2) NOT NULL,
  cidade VARCHAR(28) NOT NULL,
  num_resid VARCHAR(7) NOT NULL,
  complemento VARCHAR(250) NOT NULL,
  login VARCHAR(50) NOT NULL,
  logradouro VARCHAR(250) NOT NULL,
  bairro VARCHAR(100) NOT NULL,
  cpf VARCHAR(11) NOT NULL,
  dt_nasc DATE NOT NULL,
  PRIMARY KEY (id_usuario)
);

CREATE TABLE instituicao
(
  id_inst INT NOT NULL,
  nome_inst VARCHAR(250) NOT NULL,
  PRIMARY KEY (id_inst)
);

CREATE TABLE indicacao
(
  id_indicacao INT NOT NULL,
  descricao VARCHAR(250) NOT NULL,
  PRIMARY KEY (id_indicacao)
);

CREATE TABLE mac
(
  id_mac INT NOT NULL,
  descricao VARCHAR(250) NOT NULL,
  PRIMARY KEY (id_mac)
);

CREATE TABLE histo_ntg
(
  id_histo_ntg INT NOT NULL,
  descricao VARCHAR(250) NOT NULL,
  PRIMARY KEY (id_histo_ntg)
);

CREATE TABLE mensagens
(
  id_msg INT NOT NULL,
  msg VARCHAR(250) NOT NULL,
  data DATE NOT NULL,
  remetente INT NOT NULL,
  destinatario INT NOT NULL,
  FOREIGN KEY (remetente) REFERENCES usuario(id_usuario),
  FOREIGN KEY (destinatario) REFERENCES usuario(id_usuario)
);

CREATE TABLE med_coord
(
  crm VARCHAR(15) NOT NULL,
  uf_crm VARCHAR(2) NOT NULL,
  categoria ENUM('Acadêmico','Residente','Contratado','Pós-Graduando','Docente','Outros') NOT NULL,
  id_med_coord INT NOT NULL,
  id_inst INT NOT NULL,
  PRIMARY KEY (id_med_coord),
  FOREIGN KEY (id_med_coord) REFERENCES usuario(id_usuario),
  FOREIGN KEY (id_inst) REFERENCES instituicao(id_inst)
);

CREATE TABLE paciente
(
  sus VARCHAR(15) NOT NULL,
  rh VARCHAR(10) NOT NULL,
  cor ENUM('Branca','Preta','Amarela','Parda','Indígena','sem Declaração') NOT NULL,
  id_paciente INT NOT NULL,
  id_indicacao INT NOT NULL,
  preceptor INT NOT NULL,
  PRIMARY KEY (id_paciente),
  FOREIGN KEY (id_paciente) REFERENCES usuario(id_usuario),
  FOREIGN KEY (id_indicacao) REFERENCES indicacao(id_indicacao),
  FOREIGN KEY (preceptor) REFERENCES med_coord(id_med_coord)
);

CREATE TABLE registro_mola
(
  id_r_mola INT NOT NULL,
  idade INT NOT NULL,
  escolaridade ENUM('não informado', 'sem instrução/fundamental incompleto', ' fundamental completo/médio incompleto', 'médio completo/superior incompleto', 'superior completo/Pós-graduação incompleto', 'Pós-graduação completo') NOT NULL,
  peso NUMERIC(5,2) NOT NULL,
  altura NUMERIC(3,2) NOT NULL,
  imc NUMERIC(4,2) NOT NULL,
  n_partos INT NOT NULL,
  mola_prev INT NOT NULL,
  abortos INT NOT NULL,
  ecto INT NOT NULL,
  dum_data DATE NOT NULL,
  dum_conhecido INT NOT NULL,
  dum_consulta DATE NOT NULL,
  data_esvaz1 DATE NOT NULL,
  ig_esvaz1 INT NOT NULL,
  estado_civil ENUM('casada', 'divorciada', 'Viúva', 'Solteira','Em união estável', 'Não desejo declarar') NOT NULL,
  tipo_esvaz1 ENUM('aspiração eletrica', 'AMIU', 'curetagem', 'HTA com mola') NOT NULL,
  local_esvaz1 ENUM('HSP', 'outros') NOT NULL,
  hosp_esvaz1 VARCHAR(250) NOT NULL,
  nat_hosp_esvaz1 ENUM('Público', 'Particular') NOT NULL,
  esvaz2 INT NOT NULL,
  data_esvaz2 DATE NOT NULL,
  interv_esvaz INT NOT NULL,
  ntg INT NOT NULL,
  beta INT NOT NULL,
  us ENUM('não tem', 'típico de MH', 'Alterações hidrópicas sugestivas de mola SEM embrião', 'alterações hidrópicas sugestivas de mola COM embrião', 'gestação não evolutivaSEM embrião', 'gestação não evolutiva COM embrião', 'imagem de restos ovulares', 'gemelar feto normal + mola') NOT NULL,
  rev INT NOT NULL,
  sangramento INT NOT NULL,
  hb INT NOT NULL,
  pressao_alta INT NOT NULL,
  tsh_disp INT NOT NULL,
  tsh_valor INT NOT NULL,
  cistos INT NOT NULL,
  utero_ig INT NOT NULL,
  raiox INT NOT NULL,
  entada_servico ENUM('esvaziamento no HSP', 'para acompanhamento pós-esvaziamento', 'com suspeita ou diagnóstico de NTG', 'após tratamento de NTG') NOT NULL,
  id_paciente INT NOT NULL,
  id_mac_antes INT NOT NULL,
  id_mac_apos INT NOT NULL,
  revisor INT NOT NULL,
  med_atend INT NOT NULL,
  PRIMARY KEY (id_r_mola),
  FOREIGN KEY (id_paciente) REFERENCES paciente(id_paciente),
  FOREIGN KEY (id_mac_antes) REFERENCES mac(id_mac),
  FOREIGN KEY (id_mac_apos) REFERENCES mac(id_mac),
  FOREIGN KEY (revisor) REFERENCES med_coord(id_med_coord),
  FOREIGN KEY (med_atend) REFERENCES med_coord(id_med_coord)
);

CREATE TABLE consulta_mola
(
  id_consulta INT NOT NULL,
  quimio INT NOT NULL,
  hcg_pre_esvaz INT NOT NULL,
  data_pre_esvaz DATE NOT NULL,
  result_hcg_pre INT NOT NULL,
  obs_cons_mola VARCHAR(250) NOT NULL,
  term_caso ENUM('Evasão (abandono do serviço com hCG positivo)', 'Molar completo', 'Molar incompleto', 'NTG Completo', 'NTG Incompleto') NOT NULL,
  grau_estad ENUM('I', 'II', 'III', 'IV') NOT NULL,
  nivel_estad INT NOT NULL,
  med_atend INT NOT NULL,
  id_histo_ntg INT NOT NULL,
  revisor INT NOT NULL,
  id_r_mola INT NOT NULL,
  PRIMARY KEY (id_consulta),
  FOREIGN KEY (med_atend) REFERENCES med_coord(id_med_coord),
  FOREIGN KEY (id_histo_ntg) REFERENCES histo_ntg(id_histo_ntg),
  FOREIGN KEY (revisor) REFERENCES med_coord(id_med_coord),
  FOREIGN KEY (id_r_mola) REFERENCES registro_mola(id_r_mola)
);

CREATE TABLE anatomia_patologica
(
  id_ap INT NOT NULL,
  ap ENUM('MHC',' MHP','MH','abortamento não molar','Gemelar MHC + Feto normal','tumor trofoblástico de sítio placentário','tumor trofoblásticoepitelióide','outros') NOT NULL,
  ap_proprio INT NOT NULL,
  ap_data DATE NOT NULL,
  id_r_mola INT NOT NULL,
  PRIMARY KEY (id_ap),
  FOREIGN KEY (id_r_mola) REFERENCES registro_mola(id_r_mola)
);

CREATE TABLE quimioterapia
(
  id_quimio INT NOT NULL,
  ciclo INT NOT NULL,
  inicio DATE NOT NULL,
  fim DATE NOT NULL,
  droga VARCHAR(250) NOT NULL,
  toxicidade VARCHAR(250) NOT NULL,
  obs VARCHAR(250) NOT NULL,
  id_r_mola INT NOT NULL,
  PRIMARY KEY (id_quimio),
  FOREIGN KEY (id_r_mola) REFERENCES registro_mola(id_r_mola)
);

CREATE TABLE imagens
(
  id_imagem INT NOT NULL,
  tp_exam ENUM('RX','Ultrassom','Tomografia','HCG') NOT NULL,
  url_img VARCHAR(250) NOT NULL,
  id_r_mola INT NOT NULL,
  PRIMARY KEY (id_imagem),
  FOREIGN KEY (id_r_mola) REFERENCES registro_mola(id_r_mola)
);

CREATE TABLE hcg
(
  id_hcg INT NOT NULL,
  data_hcg DATE NOT NULL,
  result_hcg INT NOT NULL,
  lab_hcg VARCHAR(100) NOT NULL,
  rev INT NOT NULL,
  id_med_coord INT NOT NULL,
  id_r_mola INT NOT NULL,
  id_imagem INT NOT NULL,
  PRIMARY KEY (id_hcg),
  FOREIGN KEY (id_med_coord) REFERENCES med_coord(id_med_coord),
  FOREIGN KEY (id_r_mola) REFERENCES registro_mola(id_r_mola),
  FOREIGN KEY (id_imagem) REFERENCES imagens(id_imagem)
);