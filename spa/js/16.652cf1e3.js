(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{ce32:function(t,a,o){"use strict";o.r(a);var e=function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("q-page",{staticClass:"flex flex-center"},[o("q-form",{staticClass:"q-gutter-md q-pa-xs full-width row",on:{submit:t.onSubmit,reset:t.onReset}},[o("q-input",{staticClass:"q-pa-xs col-3",attrs:{label:"Nome"},model:{value:t.consultaInstituicao.nome,callback:function(a){t.$set(t.consultaInstituicao,"nome",a)},expression:"consultaInstituicao.nome"}}),o("q-input",{staticClass:"q-pa-xs col-2",attrs:{label:"CEP",mask:"#####-###"},model:{value:t.consultaInstituicao.cep,callback:function(a){t.$set(t.consultaInstituicao,"cep",a)},expression:"consultaInstituicao.cep"}}),o("q-input",{staticClass:"q-pa-xs col-3",attrs:{label:"Logradouro"},model:{value:t.consultaInstituicao.logradouro,callback:function(a){t.$set(t.consultaInstituicao,"logradouro",a)},expression:"consultaInstituicao.logradouro"}}),o("q-select",{staticClass:"q-pa-xs col-2",attrs:{options:t.optUf,label:"UF"},model:{value:t.consultaInstituicao.uf,callback:function(a){t.$set(t.consultaInstituicao,"uf",a)},expression:"consultaInstituicao.uf"}}),o("q-btn",{staticClass:"q-pa-xs q-ma-md col-1",staticStyle:{"margin-top":"2%"},attrs:{label:"Consultar",type:"submit",color:"primary"}})],1),o("div",{staticClass:"q-pa-lg",staticStyle:{"padding-bottom":"135%"}},[o("b",[t._v("Instituicões")]),o("q-btn",{attrs:{id:"btnCadastrarInst",icon:"add",flat:"",dense:"",color:"primary"},on:{click:function(){t.id_inst_popup=null,t.popupCadastro=!0}}}),o("q-table",{attrs:{data:t.dados,columns:t.columns,"row-key":"name",pagination:t.pagination},on:{"update:pagination":function(a){t.pagination=a}},scopedSlots:t._u([{key:"body",fn:function(a){return[o("q-tr",{attrs:{props:a}},[o("q-td",{key:"id",attrs:{props:a}},[t._v("\n            "+t._s(a.row.id)+"\n          ")]),o("q-td",{key:"nome",attrs:{props:a}},[t._v("\n            "+t._s(a.row.nome)+"\n          ")]),o("q-td",{key:"cep",attrs:{props:a}},[t._v("\n            "+t._s(a.row.cep)+"\n          ")]),o("q-td",{key:"logradouro",attrs:{props:a}},[t._v("\n            "+t._s(a.row.logradouro)+"\n          ")]),o("q-td",{key:"numero",attrs:{props:a}},[t._v("\n            "+t._s(a.row.numero)+"\n          ")]),o("q-td",{key:"complemento",attrs:{props:a}},[t._v("\n            "+t._s(a.row.complemento)+"\n          ")]),o("q-td",{key:"uf",attrs:{props:a}},[t._v("\n            "+t._s(a.row.uf)+"\n          ")]),o("q-td",{key:"cidade",attrs:{props:a}},[t._v("\n            "+t._s(a.row.cidade)+"\n          ")]),o("q-td",{key:"bairro",attrs:{props:a}},[t._v("\n            "+t._s(a.row.bairro)+"\n          ")]),o("q-td",{key:"editar",attrs:{props:a}},[o("q-btn",{attrs:{id:"editar",flat:"",dense:"",icon:"edit_note"},on:{click:function(o){t.popupAlterar(a.row.id)}}})],1),o("q-td",{key:"inativar",attrs:{props:a}},[o("q-toggle",{attrs:{color:"green"},on:{input:function(o){t.ativarInativar(o,a.row.id)}},model:{value:a.row.ativo,callback:function(o){t.$set(a.row,"ativo",o)},expression:"props.row.ativo"}})],1)],1)]}}])})],1),o("q-dialog",{staticClass:"full-width",model:{value:t.popupCadastro,callback:function(a){t.popupCadastro=a},expression:"popupCadastro"}},[o("CadastroEdicaoInstituicao",{attrs:{id_inst:t.id_inst_popup}})],1)],1)},i=[],n=(o("e6cf"),function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("q-card",[o("q-toolbar",{staticClass:"bg-primary text-white"},[o("q-toolbar-title",[t._v("Adicionar Instituição")]),o("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),o("q-card-section",{staticClass:"q-pt-none"},[o("q-form",{on:{submit:t.onSubmit,reset:t.onReset}},[t.id_inst?o("span",[t._v(" ID: "+t._s(t.id_inst)+" ")]):t._e(),o("q-input",{attrs:{type:"text",label:"Nome",rules:[function(t){return t.length>0||"Digite uma instituição"},function(t){return t.length<=250||"A intituição deve ter no máximo 250 caracteres"}]},model:{value:t.cadastroInstituicao.nome,callback:function(a){t.$set(t.cadastroInstituicao,"nome",a)},expression:"cadastroInstituicao.nome"}}),o("q-input",{attrs:{type:"text",label:"CEP",rules:[function(t){return t.length>0||"Digite um CEP"},function(t){return t.length<=8||"O CEP deve ter no máximo 8 caracteres"}]},model:{value:t.cadastroInstituicao.cep,callback:function(a){t.$set(t.cadastroInstituicao,"cep",a)},expression:"cadastroInstituicao.cep"}}),o("q-input",{attrs:{type:"text",label:"Logradouro",rules:[function(t){return t.length>0||"Digite um logradouro"},function(t){return t.length<=250||"O logradouro deve ter no máximo 250 caracteres"}]},model:{value:t.cadastroInstituicao.logradouro,callback:function(a){t.$set(t.cadastroInstituicao,"logradouro",a)},expression:"cadastroInstituicao.logradouro"}}),o("q-input",{attrs:{type:"text",label:"Número",rules:[function(t){return t.length>0||"Digite um número"},function(t){return t.length<=7||"O número deve ter no máximo 7 caracteres"}]},model:{value:t.cadastroInstituicao.numero,callback:function(a){t.$set(t.cadastroInstituicao,"numero",a)},expression:"cadastroInstituicao.numero"}}),o("q-input",{attrs:{type:"text",label:"Complemento"},model:{value:t.cadastroInstituicao.complemento,callback:function(a){t.$set(t.cadastroInstituicao,"complemento",a)},expression:"cadastroInstituicao.complemento"}}),o("q-input",{attrs:{type:"text",label:"UF",rules:[function(t){return t.length>0||"Digite uma Unidade da Federação"},function(t){return t.length<=2||"A Unidade da Federação deve ter no máximo 2 caracteres"}]},model:{value:t.cadastroInstituicao.uf,callback:function(a){t.$set(t.cadastroInstituicao,"uf",a)},expression:"cadastroInstituicao.uf"}}),o("q-input",{attrs:{type:"text",label:"Cidade",rules:[function(t){return t.length>0||"Digite uma cidade"},function(t){return t.length<=28||"A cidade deve ter no máximo 28 caracteres"}]},model:{value:t.cadastroInstituicao.cidade,callback:function(a){t.$set(t.cadastroInstituicao,"cidade",a)},expression:"cadastroInstituicao.cidade"}}),o("q-input",{attrs:{type:"text",label:"Bairro",rules:[function(t){return t.length>0||"Digite um bairro"},function(t){return t.length<=100||"O bairro deve ter no máximo 100 caracteres"}]},model:{value:t.cadastroInstituicao.bairro,callback:function(a){t.$set(t.cadastroInstituicao,"bairro",a)},expression:"cadastroInstituicao.bairro"}}),o("br"),o("div",{staticClass:"flex-center q-gutter-xl"},[o("q-btn",{attrs:{type:"submit",color:"primary",label:"Gravar"}})],1)],1)],1)],1)}),s=[],r={name:"cadastroInstituicao",data(){return{cadastroInstituicao:{id_inst:"",descricao:"",nome:"",cep:"",logradouro:"",numero:"",complemento:"",uf:"",cidade:"",bairro:""},modalCadastroInst:!0}},async mounted(){this.id_inst&&(console.log("alterar"),await this.carregarDadosInst(this.id_inst))},props:["id_inst"],methods:{async onSubmit(){if(this.id_inst)console.log("alterar"),await this.alterarInstituicao(this.id_inst);else{await this.incluirInstituicao()}},onReset(){this.cadastroInstituicao.descricao=""},alterarInstituicao(t){return new Promise(((a,o)=>{let e=this.cadastroInstituicao;e.id_inst=t,this.$axios.post("/alterar_instituicao",e).then((t=>{this.$router.go(),a(t.data)})).catch((t=>{this.$store.dispatch("principal/verificaErro",t),o(t)}))}))},carregarDadosInst(t){return new Promise(((a,o)=>{this.$axios.post("/dados_instituicao",{id_inst:t}).then((t=>{console.log(t.data.resultado[0].nome),this.cadastroInstituicao.nome=t.data.resultado[0].nome,this.cadastroInstituicao.cep=t.data.resultado[0].cep,this.cadastroInstituicao.logradouro=t.data.resultado[0].logradouro,this.cadastroInstituicao.numero=t.data.resultado[0].numero,this.cadastroInstituicao.complemento=t.data.resultado[0].complemento,this.cadastroInstituicao.uf=t.data.resultado[0].uf,this.cadastroInstituicao.cidade=t.data.resultado[0].cidade,this.cadastroInstituicao.bairro=t.data.resultado[0].bairro,a(t.data)})).catch((t=>{this.$store.dispatch("principal/verificaErro",t),o(t)}))}))},incluirInstituicao(){return new Promise(((t,a)=>{let o=this.cadastroInstituicao;this.$axios.post("/incluir_instituicao",o).then((a=>{this.$router.go(),t(a.data)})).catch((t=>{this.$store.dispatch("principal/verificaErro",t),a(t)}))}))}}},c=r,l=o("2877"),u=o("f09f"),d=o("65c6"),p=o("6ac5"),m=o("9c40"),f=o("a370"),b=o("0378"),g=o("27f9"),h=o("7f67"),I=o("eebe"),v=o.n(I),_=Object(l["a"])(c,n,s,!1,null,null,null),x=_.exports;v()(_,"components",{QCard:u["a"],QToolbar:d["a"],QToolbarTitle:p["a"],QBtn:m["a"],QCardSection:f["a"],QForm:b["a"],QInput:g["a"]}),v()(_,"directives",{ClosePopup:h["a"]});var q={name:"PageIndex",components:{CadastroEdicaoInstituicao:x},data(){return{popupCadastro:!1,modalCadastroInst:!1,filter:"",id_inst_popup:null,pagination:{rowsPerPage:7},consultaInstituicao:{nome:"",cep:"",logradouro:"",uf:""},optUf:["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],columns:[{name:"id",label:"Id",align:"left",field:t=>t.id,format:t=>`${t}`},{name:"nome",label:"Nome",align:"left",field:t=>t.nome,format:t=>`${t}`},{name:"cep",label:"CEP",align:"left",field:t=>t.cep,format:t=>`${t}`},{name:"logradouro",label:"Logradouro",align:"left",field:t=>t.logradouro,format:t=>`${t}`},{name:"numero",label:"Número",align:"left",field:t=>t.numero,format:t=>`${t}`},{name:"complemento",label:"Complemento",align:"left",field:t=>t.numero,format:t=>`${t}`},{name:"uf",label:"UF",align:"left",field:t=>t.uf,format:t=>`${t}`},{name:"cidade",label:"Cidade",align:"left",field:t=>t.cidade,format:t=>`${t}`},{name:"bairro",label:"Bairro",align:"left",field:t=>t.bairro,format:t=>`${t}`},{name:"editar",label:"Editar",align:"center"},{name:"inativar",label:"Inativar",align:"center"}],dados:[]}},async mounted(){this.onSubmit()},methods:{popupAlterar(t){this.id_inst_popup=t,this.popupCadastro=!0},async onSubmit(){let t=await this.consultarInstituicao(this.consultaInstituicao);console.log("result",t),t.resultado=t.resultado.map((t=>(t.ativo=Boolean(t.ativo),t))),console.log("dados",t.resultado),this.dados=t.resultado},async ativarInativar(t,a){return console.log("valor",t),console.log("id_inst",a),new Promise(((o,e)=>{this.$axios.post("/ativa_inativar_instituicao",{id_inst:Number(a),valor:Number(t)}).then((t=>{o(t.data)})).catch((t=>{this.$store.dispatch("principal/verificaErro",t),e(t)}))}))},onReset(){},async consultarInstituicao(t){return new Promise(((a,o)=>{this.$axios.post("/consultar_instituicao",t).then((t=>{a(t.data)})).catch((t=>{this.$store.dispatch("principal/verificaErro",t),o(t)}))}))},excluirInstituicao(t){return new Promise(((a,o)=>{window.confirm("Gostaria mesmo de excluir instituição?")&&this.$axios.post("/excluir_instituicao",{id:Number(t)}).then((t=>{this.onSubmit(),a(t.data)})).catch((t=>{this.$store.dispatch("principal/verificaErro",t),o(t)}))}))}}},w=q,C=o("9989"),$=o("ddd8"),y=o("eaac"),k=o("bd08"),P=o("db86"),E=o("9564"),Q=o("24e8"),S=Object(l["a"])(w,e,i,!1,null,null,null);a["default"]=S.exports;v()(S,"components",{QPage:C["a"],QForm:b["a"],QInput:g["a"],QSelect:$["a"],QBtn:m["a"],QTable:y["a"],QTr:k["a"],QTd:P["a"],QToggle:E["a"],QDialog:Q["a"]})}}]);