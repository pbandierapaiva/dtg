(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{"1fb9":function(a,e,s){"use strict";s.r(e);var t=function(){var a=this,e=a.$createElement,s=a._self._c||e;return s("q-page",[s("div",{staticClass:"text-center"},[s("b",[a._v("Gerenciamento de Espaço")])]),s("div",[s("b",[a._v("Espaço em disco no servidor")]),s("br"),a._v("\n    Total: "+a._s(a.espaco)),s("br"),a._v("\n    Usado: "+a._s(a.espaco_utilizado)),s("br"),a._v("\n    Livre: "+a._s(a.espaco_livre)+"\n  ")]),s("div",[s("q-btn",{attrs:{id:"deletar_imagens",label:"Deletar imagens sem exames",dense:"",color:"primary"},on:{click:a.deletarImagensSemExames}}),a.arquivos_deletados?s("div",[a._v("\n      Arquivos deletados: "+a._s(a.arquivos_deletados)+" Espaço liberado:\n      "+a._s(a.espaco_liberado)+"\n    ")]):a._e()],1),s("div",{staticClass:"row q-mt-md"},[s("q-input",{staticClass:"col-12 col-sm-2",attrs:{type:"date"},model:{value:a.data,callback:function(e){a.data=e},expression:"data"}}),s("div",{staticClass:"col-12"},[s("q-btn",{attrs:{id:"deletar_imagens",label:"Deletar imagens Anteriores ",dense:"",color:"primary"},on:{click:a.deletarImagensAntigas}})],1),a.arquivos_deletados_anteriores?s("div",[a._v("\n      Arquivos deletados: "+a._s(a.arquivos_deletados_anteriores)+" Espaço liberado:\n      "+a._s(a.espaco_liberado_anteriores)+"\n    ")]):a._e()],1)])},r=[],o=(s("e6cf"),{name:"gerenciamento_espaco",data(){return{espaco:0,espaco_livre:0,espaco_utilizado:0,espaco_liberado:null,arquivos_deletados:null,espaco_liberado_anteriores:null,arquivos_deletados_anteriores:null,data:null}},async mounted(){await this.carregaDadosDiscoServidor()},methods:{formatBytes(a,e=2){if(0===a)return"0 Bytes";const s=1024,t=e<0?0:e,r=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],o=Math.floor(Math.log(a)/Math.log(s));return parseFloat((a/Math.pow(s,o)).toFixed(t))+" "+r[o]},async carregaDadosDiscoServidor(){return new Promise(((a,e)=>{this.$axios.get("/espaco_servidor").then((e=>{this.espaco=this.formatBytes(e.data.espaco),this.espaco_livre=this.formatBytes(e.data.espaco_livre),this.espaco_utilizado=this.formatBytes(e.data.espaco-e.data.espaco_livre),a(e.data)})).catch((a=>{this.$store.dispatch("principal/verificaErro",a),e(a)}))}))},async deletarImagensSemExames(){return new Promise(((a,e)=>{this.$axios.post("/deletar_img_sem_exame").then((e=>{this.arquivos_deletados=e.data.qtdarquivos,this.espaco_liberado=this.formatBytes(e.data.espaco_liberado),this.carregaDadosDiscoServidor(),a(e.data)})).catch((a=>{this.$store.dispatch("principal/verificaErro",a),e(a)}))}))},async deletarImagensAntigas(){if(this.data&&confirm("Tem certeza que quer deletar todas as imagens anteriores a "+this.data+"? Esta ação é irreverssivel!!"))return new Promise(((a,e)=>{this.$axios.post("/deletar_img_anteriores",{data:this.data}).then((e=>{this.arquivos_deletados_anteriores=e.data.qtdarquivos,this.espaco_liberado_anteriores=this.formatBytes(e.data.espaco_liberado),this.carregaDadosDiscoServidor(),a(e.data)})).catch((a=>{this.$store.dispatch("principal/verificaErro",a),e(a)}))}))}}}),i=o,d=s("2877"),n=s("9989"),l=s("9c40"),c=s("27f9"),_=s("eebe"),p=s.n(_),v=Object(d["a"])(i,t,r,!1,null,null,null);e["default"]=v.exports;p()(v,"components",{QPage:n["a"],QBtn:l["a"],QInput:c["a"]})}}]);