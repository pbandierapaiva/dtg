(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[19],{"4eae":function(t,a,e){"use strict";e.r(a);var o=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("q-page",{staticClass:"flex flex-center",staticStyle:{"padding-bottom":"50%"}},[e("q-list",{staticClass:"full-width"},[e("q-expansion-item",{staticClass:"bg-info text-grey-1 text-center",attrs:{label:"Opções de consulta",group:"opcoes_consulta_paciente",dense:""}},[e("q-form",{staticClass:"bg-white flex-center full-width row",on:{submit:t.onSubmit,reset:t.onReset}},[e("q-input",{staticClass:"q-pa-xs col-12 col-sm-6 col-md-5 col-lg-5",attrs:{label:"Nome","max-length":"250",dense:""},model:{value:t.consultaUsuario.nome,callback:function(a){t.$set(t.consultaUsuario,"nome",a)},expression:"consultaUsuario.nome"}}),e("q-input",{staticClass:"q-pa-xs col-12 col-sm-6 col-md-4 col-lg-4",attrs:{label:"CPF",mask:"###.###.###-##","max-length":"11",rules:[function(t){return 0==t.length||11==t.length||"O CPF deve ter 11 dígitos"}],"unmasked-value":"",dense:""},model:{value:t.consultaUsuario.cpf,callback:function(a){t.$set(t.consultaUsuario,"cpf",a)},expression:"consultaUsuario.cpf"}}),e("q-btn",{staticClass:"q-pa-xs q-ma-md col-xs-5 col-sm-3 col-md-2 col-lg-2",attrs:{label:"Consultar",type:"submit",color:"primary",dense:""}})],1)],1)],1),e("div",{staticClass:"q-pa-sm full-width"},[e("q-table",{staticClass:"q-mt-xs",attrs:{data:t.dados,columns:t.columns,"row-key":"name",pagination:t.pagination,"visible-columns":1==t.mostrarMais?t.visibleColumnsCompleto:t.visibleColumnsPadrao},on:{"update:pagination":function(a){t.pagination=a}},scopedSlots:t._u([{key:"top",fn:function(a){return[e("b",[t._v("Relatório Evolução hCG")]),e("q-btn",{attrs:{icon:"help",color:"primary",flat:"",dense:""}},[e("q-tooltip",[t._v("\n            Este relatório apresenta, para cada paciente, o tempo em dias\n            depois do último exame não negativo e o número de exames negativos\n            consecutivos\n          ")])],1),e("q-btn",{staticClass:"on-right",attrs:{color:"primary","icon-right":"archive",label:"Exportar para CSV","no-caps":""},on:{click:t.exportTable}}),e("q-btn",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"q-ml-md",attrs:{flat:"",round:"",dense:"",icon:a.inFullscreen?"fullscreen_exit":"fullscreen"},on:{click:a.toggleFullscreen}})]}},{key:"header",fn:function(a){return[e("q-tr",[e("q-th",{key:"id_paciente",attrs:{props:a}}),e("q-th",{key:"id_r_mola",attrs:{props:a}}),e("q-th",{key:"numero_mola",attrs:{props:a}},[t._v("Nº mola")]),e("q-th",{key:"nome_paciente",attrs:{props:a}},[t._v("Nome")]),e("q-th",{key:"cpf",attrs:{props:a}},[t._v("CPF")]),e("q-th",{key:"data_ult_positivo",attrs:{props:a}},[t._v("Data UhP"),e("q-btn",{attrs:{icon:"help",color:"primary",flat:"",dense:""}},[e("q-tooltip",[t._v("\n                UhP - Último hCG Positivo\n              ")])],1)],1),e("q-th",{key:"dias_ult_positivo",attrs:{props:a}},[t._v("Dias UhP"),e("q-btn",{attrs:{icon:"help",color:"primary",flat:"",dense:""}},[e("q-tooltip",[t._v("\n                UhP - Último hCG Positivo\n              ")])],1)],1),e("q-th",{key:"exames_negativos",attrs:{props:a}},[t._v("Nº ENC"),e("q-btn",{attrs:{icon:"help",color:"primary",flat:"",dense:""}},[e("q-tooltip",[t._v("\n                ENC - Exames Negativos Consecutivos\n              ")])],1)],1),e("q-th",{key:"enviar_mensagem",attrs:{props:a}},[t._v("Enviar Mensagem")])],1)]}},{key:"body",fn:function(a){return[e("q-tr",{attrs:{props:a}},[e("q-td",{key:"id_paciente",attrs:{props:a}},[t._v("\n            "+t._s(a.row.id_paciente)+"\n          ")]),e("q-td",{key:"id_r_mola",attrs:{props:a}},[t._v("\n            "+t._s(a.row.id_r_mola)+"\n          ")]),e("q-td",{key:"numero_mola",attrs:{props:a}},[t._v("\n            "+t._s(a.row.numero_mola)+"\n          ")]),e("q-td",{key:"nome_paciente",attrs:{props:a}},[t._v("\n            "+t._s(a.row.nome_paciente)+"\n          ")]),e("q-td",{key:"cpf",attrs:{props:a}},[t._v("\n            "+t._s(a.row.cpf)+"\n          ")]),e("q-td",{key:"data_ult_positivo",attrs:{props:a}},[t._v("\n            "+t._s(null==a.row.data_ult_positivo?"Sem hCGs positivos":a.row.data_ult_positivo)+"\n          ")]),e("q-td",{key:"dias_ult_positivo",attrs:{props:a}},[t._v("\n            "+t._s(null==a.row.dias_ult_positivo?"Sem hCGs positivos":a.row.dias_ult_positivo)+"\n          ")]),e("q-td",{key:"exames_negativos",attrs:{props:a}},[t._v("\n            "+t._s(a.row.exames_negativos)+"\n          ")]),e("q-td",{key:"enviar_mensagem",attrs:{props:a}},[e("q-btn",{attrs:{id:"enviar_mensagem",to:{name:"cadastro_registro_mola",params:{id_paciente:a.row.id_paciente,id_mola:a.row.id_r_mola}},flat:"",dense:"",icon:"send"}})],1)],1)]}}])}),e("br")],1),e("q-list",{staticClass:"full-width"},[e("q-expansion-item",{staticClass:"bg-info text-grey-1 text-center",attrs:{label:"Legenda",group:"legenda",dense:""}},[e("q-card",{staticClass:"bg-white flex-center full-width row"},[e("p",{staticClass:"text-justify text-black col-12 q-mt-xs"},[e("span",{staticClass:"q-ml-sm"},[e("b",[t._v("Data UhP:  ")]),t._v("Data do último hCG positivo")])]),e("p",{staticClass:"text-justify text-black col-12 q-mt-xs"},[e("span",{staticClass:"q-ml-sm"},[e("b",[t._v("Dias UhP:  ")]),t._v("Número de dias desde o último hCG\n            positivo")])]),e("p",{staticClass:"text-justify text-black col-12 q-mt-xs"},[e("span",{staticClass:"q-ml-sm"},[e("b",[t._v("Nº ENC:     ")]),t._v("Número de exames negativos\n            consecutivos")])])])],1)],1)],1)},s=[],i=e("ded3"),n=e.n(i),l=(e("e6cf"),e("ddb0"),e("4e82"),e("2f62")),r=e("a357"),c={name:"PageIndex",data(){return{mostrarMais:!1,consultaUsuario:{nome:"",cpf:"",preceptor:"",usuario_logado:null},visibleColumnsCompleto:["numero_mola","nome_paciente","cpf","data_ult_positivo","dias_ult_positivo","exames_negativos","enviar_mensagem"],visibleColumnsPadrao:["numero_mola","nome_paciente","cpf","data_ult_positivo","dias_ult_positivo","exames_negativos","enviar_mensagem"],pagination:{rowsPerPage:10},columns:[{name:"id_paciente",label:"Id Paciente",align:"left"},{name:"id_r_mola",label:"Id Mola",align:"left"},{name:"numero_mola",label:"Nº Mola",align:"left"},{name:"nome_paciente",label:"Nome",align:"left"},{name:"cpf",label:"CPF",align:"left"},{name:"data_ult_positivo",label:"Data Último hCG Positivo",align:"left"},{name:"dias_ult_positivo",label:"Dias Último hCG Positivo",align:"left"},{name:"exames_negativos",label:"nº Exames Negativos Consecutivos",align:"left"},{name:"enviar_mensagem",label:"Enviar Mensagem",align:"center"}],dados:[],listaMolas:[]}},async mounted(){this.consultaUsuario.id_inst=this.dadosUsuarioLogado.id_inst,this.consultaUsuario.usuario_logado=this.dadosUsuarioLogado.id_usuario;let t=await this.consultarRelatorio(this.consultaUsuario,!0);t=t.resultado.map((async t=>{await this.carregarRegistrosMola(t.id_paciente);let a="";for(let n=0;n<this.listaMolas.length;n++)t.id_r_mola==this.listaMolas[n].id_r_mola&&(a=a.concat(n+1),a=a.concat("ª"));let e=t.dias_ult_positivo;if(null!=t.data_ult_positivo){e=String(t.data_ult_positivo).substring(0,10);var o=e.split("-")[0],s=e.split("-")[1],i=e.split("-")[2];e=("0"+i).slice(-2)+"/"+("0"+s).slice(-2)+"/"+o}return t.id_paciente=t.id_paciente,t.id_r_mola=t.id_r_mola,t.numero_mola=a,t.nome_paciente=t.nome_paciente,t.data_ult_positivo=e,t.dias_ult_positivo=t.dias_ult_positivo,t.exames_negativos=t.exames_negativos,t})),Promise.all(t).then((t=>{this.dados=t,this.dados=this.dados.sort((function(t,a){return 0==t.nome_paciente.localeCompare(a.nome_paciente)?t.id_r_mola<a.id_r_mola?-1:1:t.nome_paciente.localeCompare(a.nome_paciente)}))})).catch((t=>{console.error(t)}))},methods:{wrapCsvValue(t,a){let e=void 0!==a?a(t):t;return e=void 0===e||null===e?"":String(e),e=e.split('"').join('""'),`"${e}"`},exportTable(){const t=[this.columns.map((t=>this.wrapCsvValue(t.label)))].concat(this.dados.map((t=>this.columns.map((a=>this.wrapCsvValue("function"===typeof a.field?a.field(t):t[void 0===a.field?a.name:a.field],a.format))).join(",")))).join("\r\n"),a=Object(r["a"])("relatorio-evolucao-hcg.csv",t,"text/csv");!0!==a&&$q.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})},carregarRegistrosMola(t){return new Promise(((a,e)=>{this.$axios.post("/dados_r_mola",{id_paciente:t}).then((t=>{this.listaMolas=[];for(let a=0;a<t.data.resultado.length;a++)this.listaMolas.unshift(t.data.resultado[a]);a(t.data.resultado)})).catch((t=>{this.$store.dispatch("principal/verificaErro",t),e(t)}))}))},delegarUsuario(t){this.$store.dispatch("principal/delegarUsuario",t).then((()=>{}))},async onSubmit(){let t=await this.consultarRelatorio(this.consultaUsuario);t=t.resultado.map((async t=>{await this.carregarRegistrosMola(t.id_paciente);let a="";for(let e=0;e<this.listaMolas.length;e++)t.id_r_mola==this.listaMolas[e].id_r_mola&&(a=a.concat(e+1),a=a.concat("ª"));return t.id_paciente=t.id_paciente,t.id_r_mola=t.id_r_mola,t.numero_mola=a,t.nome_paciente=t.nome_paciente,t.data_ult_positivo=t.data_ult_positivo,t.dias_ult_positivo=t.dias_ult_positivo,t.exames_negativos=t.exames_negativos,t})),Promise.all(t).then((t=>{this.dados=t,this.dados=this.dados.sort((function(t,a){return 0==t.nome_paciente.localeCompare(a.nome_paciente)?t.id_r_mola<a.id_r_mola?-1:1:t.nome_paciente.localeCompare(a.nome_paciente)}))})).catch((t=>{console.error(t)}))},onReset(){},async consultarRelatorio(t){return new Promise(((a,e)=>{this.$axios.post("/relatorio/evolucao_hcg",t).then((t=>{a(t.data)})).catch((t=>{this.$store.dispatch("principal/verificaErro",t),e(t)}))}))}},computed:n()({},Object(l["c"])("principal",["usuarioLogado","dadosUsuarioLogado"]))},p=c,d=e("2877"),m=e("9989"),_=e("1c1c"),u=e("3b73"),v=e("0378"),h=e("27f9"),g=e("9c40"),f=e("eaac"),b=e("9564"),q=e("05c0"),x=e("bd08"),C=e("357e"),w=e("db86"),y=e("f09f"),k=e("eebe"),P=e.n(k),U=Object(d["a"])(p,o,s,!1,null,null,null);a["default"]=U.exports;P()(U,"components",{QPage:m["a"],QList:_["a"],QExpansionItem:u["a"],QForm:v["a"],QInput:h["a"],QBtn:g["a"],QTable:f["a"],QToggle:b["a"],QTooltip:q["a"],QTr:x["a"],QTh:C["a"],QTd:w["a"],QCard:y["a"]})}}]);